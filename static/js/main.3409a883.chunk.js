(this.webpackJsonpscanner=this.webpackJsonpscanner||[]).push([[0],{28:function(e,t,a){},29:function(e,t,a){},30:function(e,t,a){},52:function(e,t,a){},57:function(e,t,a){},58:function(e,t,a){},60:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a(2),r=a.n(s),c=a(16),i=a.n(c),o=(a(28),a(4)),l=a(5),d=a(3),u=a(7),p=a(6),h=(a.p,a(29),a(30),a(19)),g=a(20),v=a(21),S=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).changeDelayRate=function(e){var t=e.target.value;n.setState({delayRate:t}),n.props.changeDelayRate(t)},n.changeCamera=function(e){var t=e.target.value;n.setState({facingMode:t}),n.props.changeCamera(t)},n.changeServerSetting=function(e){var t=e.target.value;n.setState({serverSetting:t}),n.props.changeServerSetting(t)},n.state={facingMode:n.props.initialCamera,delayRate:n.props.initialDelayRate,serverSetting:n.props.initialServerSetting},n}return Object(l.a)(a,[{key:"render",value:function(){return Object(n.jsx)("div",{children:Object(n.jsxs)(h.slide,{isOpen:!1,children:[Object(n.jsxs)("div",{className:"settings_header",children:[Object(n.jsx)(g.a,{icon:v.a}),"Settings"]}),Object(n.jsxs)("div",{className:"settings_body",children:[Object(n.jsxs)("div",{className:"camera_settings",children:[Object(n.jsx)("label",{children:"Camera"}),Object(n.jsxs)("select",{value:this.state.facingMode,onChange:this.changeCamera,id:"camera_option",children:[Object(n.jsx)("option",{value:"user",children:"User Camera"}),Object(n.jsx)("option",{value:"environment",children:"Environment Camera"})]})]}),Object(n.jsxs)("div",{className:"scan_rate_settings",children:[Object(n.jsx)("label",{children:"Scan rate"}),Object(n.jsx)("input",{id:"delay_rate",type:"number",value:this.state.delayRate,onChange:this.changeDelayRate})]}),Object(n.jsxs)("div",{className:"server_settings",children:[Object(n.jsx)("label",{children:"Server name"}),Object(n.jsx)("input",{id:"server_setting",type:"url",value:this.state.serverSetting,onChange:this.changeServerSetting})]})]})]})})}}]),a}(s.Component),j=(a(52),a(13)),m=a.n(j),b=(a(57),function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).toggleButton=function(e){var t=!n.state.enabled;n.setState({enabled:t,startCssName:n.props.startButtonCss+(t?"":" "+n.props.startButtonExitCss),modalOverlayCssName:n.props.modalOverlayCss+(t?"":" "+n.props.modalOverlayExitCss)}),n.props.onOpen()},n.hideOverlay=function(e){n.setState({modalOverlayCssName:n.props.hiddenCss})},n.state={enabled:!0,startCssName:e.startButtonCss,modalOverlayCssName:e.modalOverlayCss},n}return Object(l.a)(a,[{key:"render",value:function(){return Object(n.jsx)("div",{children:Object(n.jsx)("div",{className:this.state.modalOverlayCssName,onAnimationEnd:this.hideOverlay,children:Object(n.jsx)("div",{className:this.state.startCssName,onClick:this.toggleButton,children:"START"})})})}}]),a}(s.Component));b.defaultProps={startButtonCss:"startButton",modalOverlayCss:"modalOverlay",hiddenCss:"hidden",startButtonExitCss:"startButtonExit",modalOverlayExitCss:"modalOverlayExit"};var O=b,f=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).handleError=function(e){},s.handleScan=function(e){for(var t,a={value:e,timestamp:new Date},n=s.state.scannedResults,r=!1,c=0;c<n.length;c++)if((t=n[c]).value===a.value){t.count=void 0!==t.count?t.count+1:0,r=!0;break}s.setState({lastReadResult:e}),r||(n.push(a),s.setState({scannedResults:n})),null!==e&&void 0!==e&&(s.props.addLog("Scanned in: "+e),s.props.processScan(e))},s.onOpen=function(){s.setState({opened:!0,scanner:Object(n.jsx)(m.a,{delay:s.state.delayRate,onError:s.handleError,onScan:s.handleScan,facingMode:s.state.currentCamera,style:{width:"500px"}})})},s.updateDelayRate=function(e){s.state.opened&&s.setState({delayRate:e,scanner:Object(n.jsx)(m.a,{delay:e,onError:s.handleError,onScan:s.handleScan,facingMode:s.state.currentCamera,style:{width:"500px"}})})},s.updateCamera=function(e){s.state.opened&&s.setState({currentCamera:e,scanner:Object(n.jsx)(m.a,{delay:s.state.delayRate,onError:s.handleError,onScan:s.handleScan,facingMode:e,style:{width:"500px"}})})},s.state={lastReadResult:"Test",opened:!1,scannedResults:[],currentCamera:s.props.currentCamera,delayRate:s.props.delayRate},s.updateDelayRate=s.updateDelayRate.bind(Object(d.a)(s)),s.updateCamera=s.updateCamera.bind(Object(d.a)(s)),s}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.props.updateDelayRate(this.updateDelayRate),this.props.updateCamera(this.updateCamera)}},{key:"render",value:function(){return Object(n.jsxs)("div",{children:[Object(n.jsx)("div",{className:"scanner",children:Object(n.jsx)("div",{className:"scanner_container",children:this.state.scanner})}),Object(n.jsx)(O,{onOpen:this.onOpen})]})}}]),a}(s.Component),C=a(12),y=(a(58),function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).updateServerUrl=function(e){n.setState({serverUrl:e})},n.addScan=function(e){if(n.scanIsLegit(e)){var t=Number.parseInt(e),a={hash:t,state:x.PROCESSING,scanTimestamp:performance.now()};if(n.state.totalScans.has(t)){var s=n.state.totalScans.get(t),r=performance.now()-s.scanTimestamp;(s.state===x.FAILED||r>3e5)&&n.signIn(t)}else{var c=n.state.totalScans;c.set(t,a),n.setState({totalScans:c}),n.signIn(t)}}},n.scanIsLegit=function(e){return void 0!==e&&null!==e&&!Number.isNaN(Number.parseInt(e))},n.signIn=function(e){var t=new XMLHttpRequest;t.addEventListener("load",(function(t){if(200===t.target.status){var a=n.state.successfulScanCount+1;n.setState({successfulScanCount:a});var s=JSON.parse(t.target.responseText),r=s.person;n.setState((function(t){var a=new Map(t.totalScans),n=Object(C.a)(Object(C.a)({},a.get(e)),{},{state:x.SIGNED_IN});return{totalScans:a.set(e,n)}})),n.props.addLog(r.givenName+" has just been signed in."),n.props.addSuccessfulSignIn(s)}else{n.setState((function(t){var a=new Map(t.totalScans),n=Object(C.a)(Object(C.a)({},a.get(e)),{},{state:x.FAILED,scanTimestamp:performance.now()});return{totalScans:a.set(e,n)}}));var c=n.state.totalScans.get(e);console.log(c)}})),t.addEventListener("error",(function(t){console.error("An error occurred while signing in the person."),n.state.totalScans.get(e).state=x.FAILED;var a=n.state.totalScans.get(e);console.log(a)})),t.open("POST",n.state.serverUrl+"/people-service/checkin/signin",!0),t.setRequestHeader("Access-Control-Allow-Headers","*"),t.setRequestHeader("Content-Type","application/json"),t.send(JSON.stringify({hash:e,message:"signing in today again"})),console.log(t)},n.state={successfulScanCount:0,totalScans:new Map,serverUrl:n.props.initialServerSetting},n.addScan=n.addScan.bind(Object(d.a)(n)),n.updateServerUrl=n.updateServerUrl.bind(Object(d.a)(n)),n.signIn=n.signIn.bind(Object(d.a)(n)),n.scanIsLegit=n.scanIsLegit.bind(Object(d.a)(n)),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.props.processScan(this.addScan),this.props.updateServerUrl(this.updateServerUrl)}},{key:"render",value:function(){for(var e,t=[],a=0;a<this.props.logs.length;a++){var s=this.props.logs[a];null===s&&(s="null"),t.push(Object(n.jsx)("div",{children:s},a))}return e=1===this.state.successfulScanCount?"person":"people",Object(n.jsxs)("div",{children:[Object(n.jsxs)("div",{children:[Object(n.jsx)("div",{className:"scanCount",children:this.state.successfulScanCount}),Object(n.jsxs)("div",{className:"scanCountText",children:[e," signed in."]})]}),t]})}}]),a}(s.Component)),x=Object.freeze({PROCESSING:{name:"PROCESSING"},SIGNED_IN:{name:"SIGNED_IN"},FAILED:{name:"FAILED"}}),R=y,I=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={total:0,scannedPeople:[]},n}return Object(l.a)(a,[{key:"render",value:function(){return Object(n.jsx)("div",{children:"Report"})}}]),a}(s.Component),N=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).addLog=function(e){var t=n.state.logs;t.push(e),t.length>10&&t.shift(),n.setState({logs:t})},n.addSuccessfulSignIn=function(e){},n.changeCamera=function(e){n.setState({currentCamera:e}),window.localStorage.setItem("qrCamera",e),n.updateCamera(e)},n.changeDelayRate=function(e){n.setState({delayRate:e}),window.localStorage.setItem("qrDelayRate",e),n.updateDelayRate(e)},n.changeServerSetting=function(e){n.setState({serverSetting:e}),window.localStorage.setItem("serverSetting",e),n.updateServerUrl(e)};var s=window.localStorage.getItem("qrCamera");void 0!==s&&null!==s||(s=n.props.currentCamera);var r=window.localStorage.getItem("qrDelayRate");void 0!==r&&null!==r||(r=n.props.delayRate),r=parseInt(r);var c=window.localStorage.getItem("serverSetting");return void 0!==c&&null!==c||(c=n.props.serverSetting),n.state={logs:[],currentCamera:s,delayRate:r,serverSetting:c,nextScan:null},n.addLog=n.addLog.bind(Object(d.a)(n)),n.changeCamera=n.changeCamera.bind(Object(d.a)(n)),n.changeDelayRate=n.changeDelayRate.bind(Object(d.a)(n)),n.changeServerSetting=n.changeServerSetting.bind(Object(d.a)(n)),n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return Object(n.jsx)("div",{className:"App",children:Object(n.jsxs)("header",{className:"App-header",children:[Object(n.jsx)(S,{initialCamera:this.state.currentCamera,initialDelayRate:this.state.delayRate,initialServerSetting:this.state.serverSetting,changeCamera:this.changeCamera,changeDelayRate:this.changeDelayRate,changeServerSetting:this.changeServerSetting}),Object(n.jsx)(f,{addLog:this.addLog,currentCamera:this.state.currentCamera,delayRate:this.state.delayRate,processScan:this.processScan,updateDelayRate:function(t){return e.updateDelayRate=t},updateCamera:function(t){return e.updateCamera=t}}),Object(n.jsx)(R,{logs:this.state.logs,initialServerSetting:this.state.serverSetting,processScan:function(t){return e.processScan=t},updateServerUrl:function(t){return e.updateServerUrl=t},addLog:this.addLog,addSuccessfulSignIn:this.addSuccessfulSignIn}),Object(n.jsx)(I,{})]})})}}]),a}(s.Component);N.defaultProps={currentCamera:"environment",delayRate:300,serverSetting:"https://localhost:8000"};var D=N,E=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,61)).then((function(t){var a=t.getCLS,n=t.getFID,s=t.getFCP,r=t.getLCP,c=t.getTTFB;a(e),n(e),s(e),r(e),c(e)}))};i.a.render(Object(n.jsx)(r.a.StrictMode,{children:Object(n.jsx)(D,{})}),document.getElementById("root")),E()}},[[60,1,2]]]);
//# sourceMappingURL=main.3409a883.chunk.js.map