(this.webpackJsonpscanner=this.webpackJsonpscanner||[]).push([[0],{28:function(e,t,a){},29:function(e,t,a){},30:function(e,t,a){},52:function(e,t,a){},57:function(e,t,a){},58:function(e,t,a){},60:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a(2),r=a.n(s),c=a(16),i=a.n(c),o=(a(28),a(4)),l=a(5),d=a(3),u=a(7),v=a(6),p=(a.p,a(29),a(30),a(21)),S=a(17),h=a(18),g=Object.freeze({UNCHECKED:{name:"UNCHECKED"},UP:{name:"UP"},DOWN:{name:"DOWN"},CHECKING:{name:"CHECKING"}}),j=function(e){Object(u.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).changeDelayRate=function(e){var t=e.target.value;n.setState({delayRate:t}),n.props.changeDelayRate(t)},n.changeCamera=function(e){var t=e.target.value;n.setState({facingMode:t}),n.props.changeCamera(t)},n.changeServerSetting=function(e){var t=e.target.value;n.setState({serverSetting:t}),n.props.changeServerSetting(t)},n.setServerUp=function(){n.setState({serverGETState:g.UP})},n.setServerDown=function(){n.setState({serverGETState:g.DOWN})},n.verifyServerGETRequest=function(){n.setState({serverGETState:g.CHECKING});var e=new XMLHttpRequest;e.addEventListener("load",(function(e){200===e.target.status?n.setState({serverGETState:g.UP}):n.setState({serverGETState:g.DOWN})})),e.addEventListener("error",(function(e){console.error("An error occurred while checking the server health."),n.setState({serverGETState:g.DOWN})})),e.open("GET",n.state.serverUrl+"/people-service/actuator/health",!0),e.setRequestHeader("Access-Control-Allow-Headers","*"),e.setRequestHeader("Content-Type","application/json"),e.send(),console.log(e)},n.state={facingMode:n.props.initialCamera,delayRate:n.props.initialDelayRate,serverUrl:n.props.initialServerSetting,serverGETState:g.UNCHECKED},n.verifyServerGETRequest=n.verifyServerGETRequest.bind(Object(d.a)(n)),n.verifyServerGETRequest(),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.props.serverIsUp(this.setServerUp),this.props.serverIsDown(this.setServerDown)}},{key:"render",value:function(){var e=this;return Object(n.jsx)("div",{children:Object(n.jsxs)(p.slide,{isOpen:!1,children:[Object(n.jsxs)("div",{className:"settings_header",children:[Object(n.jsx)(S.a,{icon:h.a}),"Settings"]}),Object(n.jsxs)("div",{className:"settings_body",children:[Object(n.jsxs)("div",{className:"camera_settings",children:[Object(n.jsx)("label",{children:"Camera"}),Object(n.jsxs)("select",{value:this.state.facingMode,onChange:this.changeCamera,id:"camera_option",children:[Object(n.jsx)("option",{value:"user",children:"User Camera"}),Object(n.jsx)("option",{value:"environment",children:"Environment Camera"})]})]}),Object(n.jsxs)("div",{className:"scan_rate_settings",children:[Object(n.jsx)("label",{children:"Scan rate"}),Object(n.jsx)("input",{id:"delay_rate",type:"number",value:this.state.delayRate,onChange:this.changeDelayRate})]}),Object(n.jsxs)("div",{className:"server_settings",children:[Object(n.jsx)("label",{children:"Server name"}),Object(n.jsx)("input",{id:"server_setting",type:"url",value:this.state.serverUrl,onChange:this.changeServerSetting})]}),Object(n.jsxs)("div",{onClick:function(){return e.verifyServerGETRequest()},children:["Server is: ",this.state.serverGETState.name,Object(n.jsx)(S.a,{icon:h.b})]})]})]})})}}]),a}(s.Component),m=(a(52),a(13)),O=a.n(m),b=(a(57),function(e){Object(u.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).toggleButton=function(e){var t=!n.state.enabled;n.setState({enabled:t,startCssName:n.props.startButtonCss+(t?"":" "+n.props.startButtonExitCss),modalOverlayCssName:n.props.modalOverlayCss+(t?"":" "+n.props.modalOverlayExitCss)}),n.props.onOpen()},n.hideOverlay=function(e){n.setState({modalOverlayCssName:n.props.hiddenCss})},n.state={enabled:!0,startCssName:e.startButtonCss,modalOverlayCssName:e.modalOverlayCss},n}return Object(l.a)(a,[{key:"render",value:function(){return Object(n.jsx)("div",{children:Object(n.jsx)("div",{className:this.state.modalOverlayCssName,onAnimationEnd:this.hideOverlay,children:Object(n.jsx)("div",{className:this.state.startCssName,onClick:this.toggleButton,children:"START"})})})}}]),a}(s.Component));b.defaultProps={startButtonCss:"startButton",modalOverlayCss:"modalOverlay",hiddenCss:"hidden",startButtonExitCss:"startButtonExit",modalOverlayExitCss:"modalOverlayExit"};var f=b,C=function(e){Object(u.a)(a,e);var t=Object(v.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).handleError=function(e){},s.handleScan=function(e){for(var t,a={value:e,timestamp:new Date},n=s.state.scannedResults,r=!1,c=0;c<n.length;c++)if((t=n[c]).value===a.value){t.count=void 0!==t.count?t.count+1:0,r=!0;break}s.setState({lastReadResult:e}),r||(n.push(a),s.setState({scannedResults:n})),null!==e&&void 0!==e&&(s.props.addLog("Scanned in: "+e),s.props.processScan(e))},s.onOpen=function(){s.setState({opened:!0,scanner:Object(n.jsx)(O.a,{delay:s.state.delayRate,onError:s.handleError,onScan:s.handleScan,facingMode:s.state.currentCamera,style:{width:"500px"}})})},s.updateDelayRate=function(e){s.state.opened&&s.setState({delayRate:e,scanner:Object(n.jsx)(O.a,{delay:e,onError:s.handleError,onScan:s.handleScan,facingMode:s.state.currentCamera,style:{width:"500px"}})})},s.updateCamera=function(e){s.state.opened&&s.setState({currentCamera:e,scanner:Object(n.jsx)(O.a,{delay:s.state.delayRate,onError:s.handleError,onScan:s.handleScan,facingMode:e,style:{width:"500px"}})})},s.state={lastReadResult:"Test",opened:!1,scannedResults:[],currentCamera:s.props.currentCamera,delayRate:s.props.delayRate},s.updateDelayRate=s.updateDelayRate.bind(Object(d.a)(s)),s.updateCamera=s.updateCamera.bind(Object(d.a)(s)),s}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.props.updateDelayRate(this.updateDelayRate),this.props.updateCamera(this.updateCamera)}},{key:"render",value:function(){return Object(n.jsxs)("div",{children:[Object(n.jsx)("div",{className:"scanner",children:Object(n.jsx)("div",{className:"scanner_container",children:this.state.scanner})}),Object(n.jsx)(f,{onOpen:this.onOpen})]})}}]),a}(s.Component),y=a(10),R=(a(58),function(e){Object(u.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).updateServerUrl=function(e){n.setState({serverUrl:e})},n.addScan=function(e){if(n.scanIsLegit(e)){var t=Number.parseInt(e),a={hash:t,state:E.PROCESSING,scanTimestamp:performance.now()};if(n.state.totalScans.has(t)){var s=n.state.totalScans.get(t),r=performance.now()-s.scanTimestamp;(s.state===E.FAILED||r>3e5)&&n.signIn(t)}else{var c=n.state.totalScans;c.set(t,a),n.setState({totalScans:c}),n.signIn(t)}}},n.scanIsLegit=function(e){return void 0!==e&&null!==e&&!Number.isNaN(Number.parseInt(e))},n.signIn=function(e){var t=new XMLHttpRequest;t.addEventListener("load",(function(t){if(200===t.target.status){var a=JSON.parse(t.target.responseText),s=a.person;n.setState((function(t){var a=new Map(t.totalScans),n=Object(y.a)(Object(y.a)({},a.get(e)),{},{state:E.SIGNED_IN});return{totalScans:a.set(e,n)}}));var r=n.state.successfulScanCount+1,c=s.givenName+" "+s.familyName+" has just been signed in.",i=n.state.successLogs;i.unshift(c),n.setState({successLogs:i,successfulScanCount:r}),n.props.addLog(c),n.props.addSuccessfulSignIn(a)}else{n.setState((function(t){var a=new Map(t.totalScans),n=Object(y.a)(Object(y.a)({},a.get(e)),{},{state:E.FAILED,scanTimestamp:performance.now()});return{totalScans:a.set(e,n)}}));n.state.totalScans.get(e)}n.props.serverIsUp()})),t.addEventListener("error",(function(t){console.error("An error occurred while signing in the person."),n.setState((function(t){var a=new Map(t.totalScans),n=Object(y.a)(Object(y.a)({},a.get(e)),{},{state:E.FAILED,scanTimestamp:performance.now()});return{totalScans:a.set(e,n)}})),n.props.serverIsDown()})),t.open("POST",n.state.serverUrl+"/people-service/checkin/signin",!0),t.setRequestHeader("Access-Control-Allow-Headers","*"),t.setRequestHeader("Content-Type","application/json"),t.send(JSON.stringify({hash:e,message:"signing in today again"})),console.log(t)},n.state={successfulScanCount:0,totalScans:new Map,serverUrl:n.props.initialServerSetting,successLogs:[]},n.addScan=n.addScan.bind(Object(d.a)(n)),n.updateServerUrl=n.updateServerUrl.bind(Object(d.a)(n)),n.signIn=n.signIn.bind(Object(d.a)(n)),n.scanIsLegit=n.scanIsLegit.bind(Object(d.a)(n)),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.props.processScan(this.addScan),this.props.updateServerUrl(this.updateServerUrl)}},{key:"render",value:function(){for(var e,t=[],a=0;a<this.props.logs.length;a++){var s=this.props.logs[a];null===s&&(s="null"),t.unshift(Object(n.jsx)("div",{children:s},a))}return e=1===this.state.successfulScanCount?"person":"people",Object(n.jsxs)("div",{children:[Object(n.jsxs)("div",{children:[Object(n.jsx)("div",{className:"scanCount",children:this.state.successfulScanCount}),Object(n.jsxs)("div",{className:"scanCountText",children:[e," signed in."]})]}),t]})}}]),a}(s.Component)),E=Object.freeze({PROCESSING:{name:"PROCESSING"},SIGNED_IN:{name:"SIGNED_IN"},FAILED:{name:"FAILED"}}),x=R,D=function(e){Object(u.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={total:0,scannedPeople:[]},n}return Object(l.a)(a,[{key:"render",value:function(){return Object(n.jsx)("div",{children:"Report"})}}]),a}(s.Component),I=function(e){Object(u.a)(a,e);var t=Object(v.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).addLog=function(e){var t=n.state.logs;t.push(e),t.length>10&&t.shift(),n.setState({logs:t})},n.addSuccessfulSignIn=function(e){},n.changeCamera=function(e){n.setState({currentCamera:e}),window.localStorage.setItem("qrCamera",e),n.updateCamera(e)},n.changeDelayRate=function(e){n.setState({delayRate:e}),window.localStorage.setItem("qrDelayRate",e),n.updateDelayRate(e)},n.changeServerSetting=function(e){n.setState({serverSetting:e}),window.localStorage.setItem("serverSetting",e),n.updateServerUrl(e)},n.serverIsUp=function(){n.setState({serverState:g.UP}),n.setServerSettingUp()},n.serverIsDown=function(){n.setState({serverState:g.DOWN}),n.setServerSettingDown()};var s=window.localStorage.getItem("qrCamera");void 0!==s&&null!==s||(s=n.props.currentCamera);var r=window.localStorage.getItem("qrDelayRate");void 0!==r&&null!==r||(r=n.props.delayRate),r=parseInt(r);var c=window.localStorage.getItem("serverSetting");return void 0!==c&&null!==c||(c=n.props.serverSetting),n.state={logs:[],currentCamera:s,delayRate:r,serverSetting:c,nextScan:null,serverState:g.UNCHECKED},n.addLog=n.addLog.bind(Object(d.a)(n)),n.changeCamera=n.changeCamera.bind(Object(d.a)(n)),n.changeDelayRate=n.changeDelayRate.bind(Object(d.a)(n)),n.changeServerSetting=n.changeServerSetting.bind(Object(d.a)(n)),n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return Object(n.jsx)("div",{className:"App",children:Object(n.jsxs)("header",{className:"App-header",children:[Object(n.jsx)(j,{initialCamera:this.state.currentCamera,initialDelayRate:this.state.delayRate,initialServerSetting:this.state.serverSetting,changeCamera:this.changeCamera,changeDelayRate:this.changeDelayRate,changeServerSetting:this.changeServerSetting,serverIsDown:function(t){return e.setServerSettingDown=t},serverIsUp:function(t){return e.setServerSettingUp=t}}),Object(n.jsx)(C,{addLog:this.addLog,currentCamera:this.state.currentCamera,delayRate:this.state.delayRate,processScan:this.processScan,updateDelayRate:function(t){return e.updateDelayRate=t},updateCamera:function(t){return e.updateCamera=t}}),Object(n.jsx)(x,{logs:this.state.logs,initialServerSetting:this.state.serverSetting,processScan:function(t){return e.processScan=t},updateServerUrl:function(t){return e.updateServerUrl=t},addLog:this.addLog,addSuccessfulSignIn:this.addSuccessfulSignIn,serverIsUp:this.serverIsUp,serverIsDown:this.serverIsDown}),Object(n.jsx)(D,{})]})})}}]),a}(s.Component);I.defaultProps={currentCamera:"environment",delayRate:300,serverSetting:"https://localhost:8000"};var N=I,w=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,61)).then((function(t){var a=t.getCLS,n=t.getFID,s=t.getFCP,r=t.getLCP,c=t.getTTFB;a(e),n(e),s(e),r(e),c(e)}))};i.a.render(Object(n.jsx)(r.a.StrictMode,{children:Object(n.jsx)(N,{})}),document.getElementById("root")),w()}},[[60,1,2]]]);
//# sourceMappingURL=main.06454d90.chunk.js.map